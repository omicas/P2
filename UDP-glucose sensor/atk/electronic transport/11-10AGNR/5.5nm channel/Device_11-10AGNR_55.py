# -*- coding: utf-8 -*-
# -------------------------------------------------------------
# Two-probe Configuration
# -------------------------------------------------------------

# -------------------------------------------------------------
# Left Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 30.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 8.52516000012]*Angstrom
left_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
left_electrode_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon]

# Define coordinates
left_electrode_coordinates = [[  6.            ,  10.077996579117,   0.710429999994],
                              [  6.            ,  12.538998289557,   0.710429999994],
                              [  6.            ,  15.000000000032,   0.710429999994],
                              [  6.            ,  17.461001710437,   0.710429999994],
                              [  6.            ,  19.922003420877,   0.710429999994],
                              [  6.            ,   7.903528101467,   0.875860039191],
                              [  6.            ,  22.096471898527,   0.875860039191],
                              [  6.            ,   8.847495723897,   1.420859999976],
                              [  6.            ,  11.308497434337,   1.420859999976],
                              [  6.            ,  13.769499144742,   1.420859999976],
                              [  6.            ,  16.230500855252,   1.420859999976],
                              [  6.            ,  18.691502565657,   1.420859999976],
                              [  6.            ,  21.152504276097,   1.420859999976],
                              [  6.            ,   8.847495723897,   2.841719999943],
                              [  6.            ,  11.308497434337,   2.841719999943],
                              [  6.            ,  13.769499144742,   2.841719999943],
                              [  6.            ,  16.230500855252,   2.841719999943],
                              [  6.            ,  18.691502565657,   2.841719999943],
                              [  6.            ,  21.152504276097,   2.841719999943],
                              [  6.            ,   7.903528101467,   3.38671996101 ],
                              [  6.            ,  22.096471898527,   3.38671996101 ],
                              [  6.            ,  10.077996579117,   3.552150000066],
                              [  6.            ,  12.538998289557,   3.552150000066],
                              [  6.            ,  15.000000000032,   3.552150000066],
                              [  6.            ,  17.461001710437,   3.552150000066],
                              [  6.            ,  19.922003420877,   3.552150000066],
                              [  6.            ,  10.077996579117,   4.973010000054],
                              [  6.            ,  12.538998289557,   4.973010000054],
                              [  6.            ,  15.000000000032,   4.973010000054],
                              [  6.            ,  17.461001710437,   4.973010000054],
                              [  6.            ,  19.922003420877,   4.973010000054],
                              [  6.            ,   7.903528101467,   5.138440039251],
                              [  6.            ,  22.096471898527,   5.138440039251],
                              [  6.            ,   8.847495723897,   5.683440000036],
                              [  6.            ,  11.308497434337,   5.683440000036],
                              [  6.            ,  13.769499144742,   5.683440000036],
                              [  6.            ,  16.230500855252,   5.683440000036],
                              [  6.            ,  18.691502565657,   5.683440000036],
                              [  6.            ,  21.152504276097,   5.683440000036],
                              [  6.            ,   8.847495723897,   7.104300000003],
                              [  6.            ,  11.308497434337,   7.104300000003],
                              [  6.            ,  13.769499144742,   7.104300000003],
                              [  6.            ,  16.230500855252,   7.104300000003],
                              [  6.            ,  18.691502565657,   7.104300000003],
                              [  6.            ,  21.152504276097,   7.104300000003],
                              [  6.            ,   7.903528101467,   7.64929996107 ],
                              [  6.            ,  22.096471898527,   7.64929996107 ],
                              [  6.            ,  10.077996579117,   7.814730000126],
                              [  6.            ,  12.538998289557,   7.814730000126],
                              [  6.            ,  15.000000000032,   7.814730000126],
                              [  6.            ,  17.461001710437,   7.814730000126],
                              [  6.            ,  19.922003420877,   7.814730000126]]*Angstrom

# Set up configuration
left_electrode = BulkConfiguration(
    bravais_lattice=left_electrode_lattice,
    elements=left_electrode_elements,
    cartesian_coordinates=left_electrode_coordinates
    )

# -------------------------------------------------------------
# Right Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 30.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 8.52516000012]*Angstrom
right_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
right_electrode_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                            Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                            Carbon, Carbon, Carbon, Carbon]

# Define coordinates
right_electrode_coordinates = [[  6.            ,  10.077996579117,   0.710429999994],
                               [  6.            ,  12.538998289557,   0.710429999994],
                               [  6.            ,  15.000000000032,   0.710429999994],
                               [  6.            ,  17.461001710437,   0.710429999994],
                               [  6.            ,  19.922003420877,   0.710429999994],
                               [  6.            ,   7.903528101467,   0.87586003905 ],
                               [  6.            ,  22.096471898527,   0.87586003905 ],
                               [  6.            ,   8.847495723897,   1.420860000117],
                               [  6.            ,  11.308497434337,   1.420860000117],
                               [  6.            ,  13.769499144742,   1.420860000117],
                               [  6.            ,  16.230500855252,   1.420860000117],
                               [  6.            ,  18.691502565657,   1.420860000117],
                               [  6.            ,  21.152504276097,   1.420860000117],
                               [  6.            ,   8.847495723897,   2.841720000084],
                               [  6.            ,  11.308497434337,   2.841720000084],
                               [  6.            ,  13.769499144742,   2.841720000084],
                               [  6.            ,  16.230500855252,   2.841720000084],
                               [  6.            ,  18.691502565657,   2.841720000084],
                               [  6.            ,  21.152504276097,   2.841720000084],
                               [  6.            ,   7.903528101467,   3.386719960869],
                               [  6.            ,  22.096471898527,   3.386719960869],
                               [  6.            ,  10.077996579117,   3.552150000066],
                               [  6.            ,  12.538998289557,   3.552150000066],
                               [  6.            ,  15.000000000032,   3.552150000066],
                               [  6.            ,  17.461001710437,   3.552150000066],
                               [  6.            ,  19.922003420877,   3.552150000066],
                               [  6.            ,  10.077996579117,   4.973010000054],
                               [  6.            ,  12.538998289557,   4.973010000054],
                               [  6.            ,  15.000000000032,   4.973010000054],
                               [  6.            ,  17.461001710437,   4.973010000054],
                               [  6.            ,  19.922003420877,   4.973010000054],
                               [  6.            ,   7.903528101467,   5.13844003911 ],
                               [  6.            ,  22.096471898527,   5.13844003911 ],
                               [  6.            ,   8.847495723897,   5.683440000177],
                               [  6.            ,  11.308497434337,   5.683440000177],
                               [  6.            ,  13.769499144742,   5.683440000177],
                               [  6.            ,  16.230500855252,   5.683440000177],
                               [  6.            ,  18.691502565657,   5.683440000177],
                               [  6.            ,  21.152504276097,   5.683440000177],
                               [  6.            ,   8.847495723897,   7.104300000144],
                               [  6.            ,  11.308497434337,   7.104300000144],
                               [  6.            ,  13.769499144742,   7.104300000144],
                               [  6.            ,  16.230500855252,   7.104300000144],
                               [  6.            ,  18.691502565657,   7.104300000144],
                               [  6.            ,  21.152504276097,   7.104300000144],
                               [  6.            ,   7.903528101467,   7.649299960929],
                               [  6.            ,  22.096471898527,   7.649299960929],
                               [  6.            ,  10.077996579117,   7.814730000126],
                               [  6.            ,  12.538998289557,   7.814730000126],
                               [  6.            ,  15.000000000032,   7.814730000126],
                               [  6.            ,  17.461001710437,   7.814730000126],
                               [  6.            ,  19.922003420877,   7.814730000126]]*Angstrom

# Set up configuration
right_electrode = BulkConfiguration(
    bravais_lattice=right_electrode_lattice,
    elements=right_electrode_elements,
    cartesian_coordinates=right_electrode_coordinates
    )

# -------------------------------------------------------------
# Central Region
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 30.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 80.98902]*Angstrom
central_region_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
central_region_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon]

# Define coordinates
central_region_coordinates = [[  6.            ,  10.077996579117,   0.710429999994],
                              [  6.            ,  12.538998289557,   0.710429999994],
                              [  6.            ,  15.000000000032,   0.710429999994],
                              [  6.            ,  17.461001710437,   0.710429999994],
                              [  6.            ,  19.922003420877,   0.710429999994],
                              [  6.            ,   7.903528101467,   0.875860039191],
                              [  6.            ,  22.096471898527,   0.875860039191],
                              [  6.            ,   8.847495723897,   1.420859999976],
                              [  6.            ,  11.308497434337,   1.420859999976],
                              [  6.            ,  13.769499144742,   1.420859999976],
                              [  6.            ,  16.230500855252,   1.420859999976],
                              [  6.            ,  18.691502565657,   1.420859999976],
                              [  6.            ,  21.152504276097,   1.420859999976],
                              [  6.            ,   8.847495723897,   2.841719999943],
                              [  6.            ,  11.308497434337,   2.841719999943],
                              [  6.            ,  13.769499144742,   2.841719999943],
                              [  6.            ,  16.230500855252,   2.841719999943],
                              [  6.            ,  18.691502565657,   2.841719999943],
                              [  6.            ,  21.152504276097,   2.841719999943],
                              [  6.            ,   7.903528101467,   3.38671996101 ],
                              [  6.            ,  22.096471898527,   3.38671996101 ],
                              [  6.            ,  10.077996579117,   3.552150000066],
                              [  6.            ,  12.538998289557,   3.552150000066],
                              [  6.            ,  15.000000000032,   3.552150000066],
                              [  6.            ,  17.461001710437,   3.552150000066],
                              [  6.            ,  19.922003420877,   3.552150000066],
                              [  6.            ,  10.077996579117,   4.973010000054],
                              [  6.            ,  12.538998289557,   4.973010000054],
                              [  6.            ,  15.000000000032,   4.973010000054],
                              [  6.            ,  17.461001710437,   4.973010000054],
                              [  6.            ,  19.922003420877,   4.973010000054],
                              [  6.            ,   7.903528101467,   5.138440039251],
                              [  6.            ,  22.096471898527,   5.138440039251],
                              [  6.            ,   8.847495723897,   5.683440000036],
                              [  6.            ,  11.308497434337,   5.683440000036],
                              [  6.            ,  13.769499144742,   5.683440000036],
                              [  6.            ,  16.230500855252,   5.683440000036],
                              [  6.            ,  18.691502565657,   5.683440000036],
                              [  6.            ,  21.152504276097,   5.683440000036],
                              [  6.            ,   8.847495723897,   7.104300000003],
                              [  6.            ,  11.308497434337,   7.104300000003],
                              [  6.            ,  13.769499144742,   7.104300000003],
                              [  6.            ,  16.230500855252,   7.104300000003],
                              [  6.            ,  18.691502565657,   7.104300000003],
                              [  6.            ,  21.152504276097,   7.104300000003],
                              [  6.            ,   7.903528101467,   7.64929996107 ],
                              [  6.            ,  22.096471898527,   7.64929996107 ],
                              [  6.            ,  10.077996579117,   7.814730000126],
                              [  6.            ,  12.538998289557,   7.814730000126],
                              [  6.            ,  15.000000000032,   7.814730000126],
                              [  6.            ,  17.461001710437,   7.814730000126],
                              [  6.            ,  19.922003420877,   7.814730000126],
                              [  6.            ,  10.077996579117,   9.235590000114],
                              [  6.            ,  12.538998289557,   9.235590000114],
                              [  6.            ,  15.000000000032,   9.235590000114],
                              [  6.            ,  17.461001710437,   9.235590000114],
                              [  6.            ,  19.922003420877,   9.235590000114],
                              [  6.            ,   7.903528101467,   9.401020039311],
                              [  6.            ,  22.096471898527,   9.401020039311],
                              [  6.            ,   8.847495723897,   9.946020000096],
                              [  6.            ,  11.308497434337,   9.946020000096],
                              [  6.            ,  13.769499144742,   9.946020000096],
                              [  6.            ,  16.230500855252,   9.946020000096],
                              [  6.            ,  18.691502565657,   9.946020000096],
                              [  6.            ,  21.152504276097,   9.946020000096],
                              [  6.            ,   8.847495723897,  11.366880000063],
                              [  6.            ,  11.308497434376,  11.366880000063],
                              [  6.            ,  13.769499144793,  11.366880000063],
                              [  6.            ,  16.230500855252,  11.366880000063],
                              [  6.            ,  18.69150256567 ,  11.366880000063],
                              [  6.            ,  21.152504276129,  11.366880000063],
                              [  6.            ,  22.096471898533,  11.911879960965],
                              [  6.            ,   7.903528101467,  11.91187996113 ],
                              [  6.            ,  10.077996579146,  12.077310000061],
                              [  6.            ,  12.538998289605,  12.077310000061],
                              [  6.            ,  15.000000000023,  12.077310000061],
                              [  6.            ,  17.461001710482,  12.077310000061],
                              [  6.            ,  19.922003420899,  12.077310000061],
                              [  6.            ,  10.077996579146,  13.498170000063],
                              [  6.            ,  12.538998289605,  13.498170000063],
                              [  6.            ,  15.000000000023,  13.498170000063],
                              [  6.            ,  17.461001710482,  13.498170000063],
                              [  6.            ,  19.922003420899,  13.498170000063],
                              [  6.            ,  22.096471898533,  13.663600039159],
                              [  6.            ,   9.134028956742,  14.043169960965],
                              [  6.            ,  11.308497434376,  14.208600000061],
                              [  6.            ,  13.769499144793,  14.208600000061],
                              [  6.            ,  16.230500855252,  14.208600000061],
                              [  6.            ,  18.69150256567 ,  14.208600000061],
                              [  6.            ,  21.152504276129,  14.208600000061],
                              [  6.            ,  11.308497434376,  15.629460000063],
                              [  6.            ,  13.769499144793,  15.629460000063],
                              [  6.            ,  16.230500855252,  15.629460000063],
                              [  6.            ,  18.69150256567 ,  15.629460000063],
                              [  6.            ,  21.152504276129,  15.629460000063],
                              [  6.            ,   9.134028956742,  15.794890039159],
                              [  6.            ,  22.096471898533,  16.174459960965],
                              [  6.            ,  10.077996579146,  16.339890000061],
                              [  6.            ,  12.538998289605,  16.339890000061],
                              [  6.            ,  15.000000000023,  16.339890000061],
                              [  6.            ,  17.461001710482,  16.339890000061],
                              [  6.            ,  19.922003420899,  16.339890000061],
                              [  6.            ,  10.077996579146,  17.760750000063],
                              [  6.            ,  12.538998289605,  17.760750000063],
                              [  6.            ,  15.000000000023,  17.760750000063],
                              [  6.            ,  17.461001710482,  17.760750000063],
                              [  6.            ,  19.922003420899,  17.760750000063],
                              [  6.            ,  22.096471898533,  17.926180039159],
                              [  6.            ,   9.134028956742,  18.305749960965],
                              [  6.            ,  11.308497434376,  18.471180000061],
                              [  6.            ,  13.769499144793,  18.471180000061],
                              [  6.            ,  16.230500855252,  18.471180000061],
                              [  6.            ,  18.69150256567 ,  18.471180000061],
                              [  6.            ,  21.152504276129,  18.471180000061],
                              [  6.            ,  11.308497434376,  19.892040000063],
                              [  6.            ,  13.769499144793,  19.892040000063],
                              [  6.            ,  16.230500855252,  19.892040000063],
                              [  6.            ,  18.69150256567 ,  19.892040000063],
                              [  6.            ,  21.152504276129,  19.892040000063],
                              [  6.            ,   9.134028956742,  20.057470039159],
                              [  6.            ,  22.096471898533,  20.437039960965],
                              [  6.            ,  10.077996579146,  20.602470000061],
                              [  6.            ,  12.538998289605,  20.602470000061],
                              [  6.            ,  15.000000000023,  20.602470000061],
                              [  6.            ,  17.461001710482,  20.602470000061],
                              [  6.            ,  19.922003420899,  20.602470000061],
                              [  6.            ,  10.077996579146,  22.023330000063],
                              [  6.            ,  12.538998289605,  22.023330000063],
                              [  6.            ,  15.000000000023,  22.023330000063],
                              [  6.            ,  17.461001710482,  22.023330000063],
                              [  6.            ,  19.922003420899,  22.023330000063],
                              [  6.            ,  22.096471898533,  22.188760039159],
                              [  6.            ,   9.134028956742,  22.568329960965],
                              [  6.            ,  11.308497434376,  22.733760000061],
                              [  6.            ,  13.769499144793,  22.733760000061],
                              [  6.            ,  16.230500855252,  22.733760000061],
                              [  6.            ,  18.69150256567 ,  22.733760000061],
                              [  6.            ,  21.152504276129,  22.733760000061],
                              [  6.            ,  11.308497434376,  24.154620000063],
                              [  6.            ,  13.769499144793,  24.154620000063],
                              [  6.            ,  16.230500855252,  24.154620000063],
                              [  6.            ,  18.69150256567 ,  24.154620000063],
                              [  6.            ,  21.152504276129,  24.154620000063],
                              [  6.            ,   9.134028956742,  24.320050039159],
                              [  6.            ,  22.096471898533,  24.699619960965],
                              [  6.            ,  10.077996579146,  24.865050000061],
                              [  6.            ,  12.538998289605,  24.865050000061],
                              [  6.            ,  15.000000000023,  24.865050000061],
                              [  6.            ,  17.461001710482,  24.865050000061],
                              [  6.            ,  19.922003420899,  24.865050000061],
                              [  6.            ,  10.077996579146,  26.285910000063],
                              [  6.            ,  12.538998289605,  26.285910000063],
                              [  6.            ,  15.000000000023,  26.285910000063],
                              [  6.            ,  17.461001710482,  26.285910000063],
                              [  6.            ,  19.922003420899,  26.285910000063],
                              [  6.            ,  22.096471898533,  26.451340039159],
                              [  6.            ,   9.134028956742,  26.830909960965],
                              [  6.            ,  11.308497434376,  26.996340000061],
                              [  6.            ,  13.769499144793,  26.996340000061],
                              [  6.            ,  16.230500855252,  26.996340000061],
                              [  6.            ,  18.69150256567 ,  26.996340000061],
                              [  6.            ,  21.152504276129,  26.996340000061],
                              [  6.            ,  11.308497434376,  28.417200000063],
                              [  6.            ,  13.769499144793,  28.417200000063],
                              [  6.            ,  16.230500855252,  28.417200000063],
                              [  6.            ,  18.69150256567 ,  28.417200000063],
                              [  6.            ,  21.152504276129,  28.417200000063],
                              [  6.            ,   9.134028956742,  28.582630039159],
                              [  6.            ,  22.096471898533,  28.962199960965],
                              [  6.            ,  10.077996579146,  29.127630000061],
                              [  6.            ,  12.538998289605,  29.127630000061],
                              [  6.            ,  15.000000000023,  29.127630000061],
                              [  6.            ,  17.461001710482,  29.127630000061],
                              [  6.            ,  19.922003420899,  29.127630000061],
                              [  6.            ,  10.077996579146,  30.548490000063],
                              [  6.            ,  12.538998289605,  30.548490000063],
                              [  6.            ,  15.000000000023,  30.548490000063],
                              [  6.            ,  17.461001710482,  30.548490000063],
                              [  6.            ,  19.922003420899,  30.548490000063],
                              [  6.            ,  22.096471898533,  30.713920039159],
                              [  6.            ,   9.134028956742,  31.093489960965],
                              [  6.            ,  11.308497434376,  31.258920000061],
                              [  6.            ,  13.769499144793,  31.258920000061],
                              [  6.            ,  16.230500855252,  31.258920000061],
                              [  6.            ,  18.69150256567 ,  31.258920000061],
                              [  6.            ,  21.152504276129,  31.258920000061],
                              [  6.            ,  11.308497434376,  32.679780000063],
                              [  6.            ,  13.769499144793,  32.679780000063],
                              [  6.            ,  16.230500855252,  32.679780000063],
                              [  6.            ,  18.69150256567 ,  32.679780000063],
                              [  6.            ,  21.152504276129,  32.679780000063],
                              [  6.            ,   9.134028956742,  32.845210039159],
                              [  6.            ,  22.096471898533,  33.224779960965],
                              [  6.            ,  10.077996579146,  33.390210000061],
                              [  6.            ,  12.538998289605,  33.390210000061],
                              [  6.            ,  15.000000000023,  33.390210000061],
                              [  6.            ,  17.461001710482,  33.390210000061],
                              [  6.            ,  19.922003420899,  33.390210000061],
                              [  6.            ,  10.077996579146,  34.811070000063],
                              [  6.            ,  12.538998289605,  34.811070000063],
                              [  6.            ,  15.000000000023,  34.811070000063],
                              [  6.            ,  17.461001710482,  34.811070000063],
                              [  6.            ,  19.922003420899,  34.811070000063],
                              [  6.            ,  22.096471898533,  34.976500039159],
                              [  6.            ,   9.134028956742,  35.356069960965],
                              [  6.            ,  11.308497434376,  35.521500000061],
                              [  6.            ,  13.769499144793,  35.521500000061],
                              [  6.            ,  16.230500855252,  35.521500000061],
                              [  6.            ,  18.69150256567 ,  35.521500000061],
                              [  6.            ,  21.152504276129,  35.521500000061],
                              [  6.            ,  11.308497434376,  36.942360000063],
                              [  6.            ,  13.769499144793,  36.942360000063],
                              [  6.            ,  16.230500855252,  36.942360000063],
                              [  6.            ,  18.69150256567 ,  36.942360000063],
                              [  6.            ,  21.152504276129,  36.942360000063],
                              [  6.            ,   9.134028956742,  37.107790039159],
                              [  6.            ,  22.096471898533,  37.487359960965],
                              [  6.            ,  10.077996579146,  37.652790000061],
                              [  6.            ,  12.538998289605,  37.652790000061],
                              [  6.            ,  15.000000000023,  37.652790000061],
                              [  6.            ,  17.461001710482,  37.652790000061],
                              [  6.            ,  19.922003420899,  37.652790000061],
                              [  6.            ,  10.077996579146,  39.073650000063],
                              [  6.            ,  12.538998289605,  39.073650000063],
                              [  6.            ,  15.000000000023,  39.073650000063],
                              [  6.            ,  17.461001710482,  39.073650000063],
                              [  6.            ,  19.922003420899,  39.073650000063],
                              [  6.            ,  22.096471898533,  39.239080039159],
                              [  6.            ,   9.134028956742,  39.618649960965],
                              [  6.            ,  11.308497434376,  39.784080000061],
                              [  6.            ,  13.769499144793,  39.784080000061],
                              [  6.            ,  16.230500855252,  39.784080000061],
                              [  6.            ,  18.69150256567 ,  39.784080000061],
                              [  6.            ,  21.152504276129,  39.784080000061],
                              [  6.            ,  11.308497434376,  41.204940000063],
                              [  6.            ,  13.769499144793,  41.204940000063],
                              [  6.            ,  16.230500855252,  41.204940000063],
                              [  6.            ,  18.69150256567 ,  41.204940000063],
                              [  6.            ,  21.152504276129,  41.204940000063],
                              [  6.            ,   9.134028956742,  41.370370039159],
                              [  6.            ,  22.096471898533,  41.749939960965],
                              [  6.            ,  10.077996579146,  41.915370000061],
                              [  6.            ,  12.538998289605,  41.915370000061],
                              [  6.            ,  15.000000000023,  41.915370000061],
                              [  6.            ,  17.461001710482,  41.915370000061],
                              [  6.            ,  19.922003420899,  41.915370000061],
                              [  6.            ,  10.077996579146,  43.336229999938],
                              [  6.            ,  12.538998289605,  43.336229999938],
                              [  6.            ,  15.000000000023,  43.336229999938],
                              [  6.            ,  17.461001710482,  43.336229999938],
                              [  6.            ,  19.922003420899,  43.336229999938],
                              [  6.            ,  22.096471898533,  43.501660039034],
                              [  6.            ,   9.134028956742,  43.88122996084 ],
                              [  6.            ,  11.308497434376,  44.046659999936],
                              [  6.            ,  13.769499144793,  44.046659999936],
                              [  6.            ,  16.230500855252,  44.046659999936],
                              [  6.            ,  18.69150256567 ,  44.046659999936],
                              [  6.            ,  21.152504276129,  44.046659999936],
                              [  6.            ,  11.308497434376,  45.467519999938],
                              [  6.            ,  13.769499144793,  45.467519999938],
                              [  6.            ,  16.230500855252,  45.467519999938],
                              [  6.            ,  18.69150256567 ,  45.467519999938],
                              [  6.            ,  21.152504276129,  45.467519999938],
                              [  6.            ,   9.134028956742,  45.632950039034],
                              [  6.            ,  22.096471898533,  46.01251996084 ],
                              [  6.            ,  10.077996579146,  46.177949999936],
                              [  6.            ,  12.538998289605,  46.177949999936],
                              [  6.            ,  15.000000000023,  46.177949999936],
                              [  6.            ,  17.461001710482,  46.177949999936],
                              [  6.            ,  19.922003420899,  46.177949999936],
                              [  6.            ,  10.077996579146,  47.598809999938],
                              [  6.            ,  12.538998289605,  47.598809999938],
                              [  6.            ,  15.000000000023,  47.598809999938],
                              [  6.            ,  17.461001710482,  47.598809999938],
                              [  6.            ,  19.922003420899,  47.598809999938],
                              [  6.            ,  22.096471898533,  47.764240039034],
                              [  6.            ,   9.134028956742,  48.14380996084 ],
                              [  6.            ,  11.308497434376,  48.309239999936],
                              [  6.            ,  13.769499144793,  48.309239999936],
                              [  6.            ,  16.230500855252,  48.309239999936],
                              [  6.            ,  18.69150256567 ,  48.309239999936],
                              [  6.            ,  21.152504276129,  48.309239999936],
                              [  6.            ,  11.308497434376,  49.730099999938],
                              [  6.            ,  13.769499144793,  49.730099999938],
                              [  6.            ,  16.230500855252,  49.730099999938],
                              [  6.            ,  18.69150256567 ,  49.730099999938],
                              [  6.            ,  21.152504276129,  49.730099999938],
                              [  6.            ,   9.134028956742,  49.895530039034],
                              [  6.            ,  22.096471898533,  50.27509996084 ],
                              [  6.            ,  10.077996579146,  50.440529999936],
                              [  6.            ,  12.538998289605,  50.440529999936],
                              [  6.            ,  15.000000000023,  50.440529999936],
                              [  6.            ,  17.461001710482,  50.440529999936],
                              [  6.            ,  19.922003420899,  50.440529999936],
                              [  6.            ,  10.077996579146,  51.861389999938],
                              [  6.            ,  12.538998289605,  51.861389999938],
                              [  6.            ,  15.000000000023,  51.861389999938],
                              [  6.            ,  17.461001710482,  51.861389999938],
                              [  6.            ,  19.922003420899,  51.861389999938],
                              [  6.            ,  22.096471898533,  52.026820039034],
                              [  6.            ,   9.134028956742,  52.40638996084 ],
                              [  6.            ,  11.308497434376,  52.571819999936],
                              [  6.            ,  13.769499144793,  52.571819999936],
                              [  6.            ,  16.230500855252,  52.571819999936],
                              [  6.            ,  18.69150256567 ,  52.571819999936],
                              [  6.            ,  21.152504276129,  52.571819999936],
                              [  6.            ,  11.308497434376,  53.992679999938],
                              [  6.            ,  13.769499144793,  53.992679999938],
                              [  6.            ,  16.230500855252,  53.992679999938],
                              [  6.            ,  18.69150256567 ,  53.992679999938],
                              [  6.            ,  21.152504276129,  53.992679999938],
                              [  6.            ,   9.134028956742,  54.158110039034],
                              [  6.            ,  22.096471898533,  54.53767996084 ],
                              [  6.            ,  10.077996579146,  54.703109999936],
                              [  6.            ,  12.538998289605,  54.703109999936],
                              [  6.            ,  15.000000000023,  54.703109999936],
                              [  6.            ,  17.461001710482,  54.703109999936],
                              [  6.            ,  19.922003420899,  54.703109999936],
                              [  6.            ,  10.077996579146,  56.123969999938],
                              [  6.            ,  12.538998289605,  56.123969999938],
                              [  6.            ,  15.000000000023,  56.123969999938],
                              [  6.            ,  17.461001710482,  56.123969999938],
                              [  6.            ,  19.922003420899,  56.123969999938],
                              [  6.            ,  22.096471898533,  56.289400039034],
                              [  6.            ,   9.134028956742,  56.66896996084 ],
                              [  6.            ,  11.308497434376,  56.834399999936],
                              [  6.            ,  13.769499144793,  56.834399999936],
                              [  6.            ,  16.230500855252,  56.834399999936],
                              [  6.            ,  18.69150256567 ,  56.834399999936],
                              [  6.            ,  21.152504276129,  56.834399999936],
                              [  6.            ,  11.308497434376,  58.255259999938],
                              [  6.            ,  13.769499144793,  58.255259999938],
                              [  6.            ,  16.230500855252,  58.255259999938],
                              [  6.            ,  18.69150256567 ,  58.255259999938],
                              [  6.            ,  21.152504276129,  58.255259999938],
                              [  6.            ,   9.134028956742,  58.420690039034],
                              [  6.            ,  22.096471898533,  58.80025996084 ],
                              [  6.            ,  10.077996579146,  58.965689999936],
                              [  6.            ,  12.538998289605,  58.965689999936],
                              [  6.            ,  15.000000000023,  58.965689999936],
                              [  6.            ,  17.461001710482,  58.965689999936],
                              [  6.            ,  19.922003420899,  58.965689999936],
                              [  6.            ,  10.077996579146,  60.386549999938],
                              [  6.            ,  12.538998289605,  60.386549999938],
                              [  6.            ,  15.000000000023,  60.386549999938],
                              [  6.            ,  17.461001710482,  60.386549999938],
                              [  6.            ,  19.922003420899,  60.386549999938],
                              [  6.            ,  22.096471898533,  60.551980039034],
                              [  6.            ,   9.134028956742,  60.93154996084 ],
                              [  6.            ,  11.308497434376,  61.096979999936],
                              [  6.            ,  13.769499144793,  61.096979999936],
                              [  6.            ,  16.230500855252,  61.096979999936],
                              [  6.            ,  18.69150256567 ,  61.096979999936],
                              [  6.            ,  21.152504276129,  61.096979999936],
                              [  6.            ,  11.308497434376,  62.517839999938],
                              [  6.            ,  13.769499144793,  62.517839999938],
                              [  6.            ,  16.230500855252,  62.517839999938],
                              [  6.            ,  18.69150256567 ,  62.517839999938],
                              [  6.            ,  21.152504276129,  62.517839999938],
                              [  6.            ,   9.134028956742,  62.683270039034],
                              [  6.            ,  22.096471898533,  63.06283996084 ],
                              [  6.            ,  10.077996579146,  63.228269999936],
                              [  6.            ,  12.538998289605,  63.228269999936],
                              [  6.            ,  15.000000000023,  63.228269999936],
                              [  6.            ,  17.461001710482,  63.228269999936],
                              [  6.            ,  19.922003420899,  63.228269999936],
                              [  6.            ,  10.077996579146,  64.649129999938],
                              [  6.            ,  12.538998289605,  64.649129999938],
                              [  6.            ,  15.000000000023,  64.649129999938],
                              [  6.            ,  17.461001710482,  64.649129999938],
                              [  6.            ,  19.922003420899,  64.649129999938],
                              [  6.            ,  22.096471898533,  64.814560039034],
                              [  6.            ,   9.134028956742,  65.19412996084 ],
                              [  6.            ,  11.308497434376,  65.359559999936],
                              [  6.            ,  13.769499144793,  65.359559999936],
                              [  6.            ,  16.230500855252,  65.359559999936],
                              [  6.            ,  18.69150256567 ,  65.359559999936],
                              [  6.            ,  21.152504276129,  65.359559999936],
                              [  6.            ,  11.308497434376,  66.780419999938],
                              [  6.            ,  13.769499144793,  66.780419999938],
                              [  6.            ,  16.230500855252,  66.780419999938],
                              [  6.            ,  18.69150256567 ,  66.780419999938],
                              [  6.            ,  21.152504276129,  66.780419999938],
                              [  6.            ,   9.134028956742,  66.945850039034],
                              [  6.            ,  22.096471898533,  67.32541996084 ],
                              [  6.            ,  10.077996579146,  67.490849999936],
                              [  6.            ,  12.538998289605,  67.490849999936],
                              [  6.            ,  15.000000000023,  67.490849999936],
                              [  6.            ,  17.461001710482,  67.490849999936],
                              [  6.            ,  19.922003420899,  67.490849999936],
                              [  6.            ,  10.077996579146,  68.911709999938],
                              [  6.            ,  12.538998289605,  68.911709999938],
                              [  6.            ,  15.000000000023,  68.911709999938],
                              [  6.            ,  17.461001710482,  68.911709999938],
                              [  6.            ,  19.922003420899,  68.911709999938],
                              [  6.            ,   7.903528101467,  69.077140038869],
                              [  6.            ,  22.096471898533,  69.077140039034],
                              [  6.            ,   8.847495723897,  69.622139999936],
                              [  6.            ,  11.308497434376,  69.622139999936],
                              [  6.            ,  13.769499144793,  69.622139999936],
                              [  6.            ,  16.230500855252,  69.622139999936],
                              [  6.            ,  18.69150256567 ,  69.622139999936],
                              [  6.            ,  21.152504276129,  69.622139999936],
                              [  6.            ,   8.847495723897,  71.042999999903],
                              [  6.            ,  11.308497434337,  71.042999999903],
                              [  6.            ,  13.769499144742,  71.042999999903],
                              [  6.            ,  16.230500855252,  71.042999999903],
                              [  6.            ,  18.691502565657,  71.042999999903],
                              [  6.            ,  21.152504276097,  71.042999999903],
                              [  6.            ,   7.903528101467,  71.587999960688],
                              [  6.            ,  22.096471898527,  71.587999960688],
                              [  6.            ,  10.077996579117,  71.753429999885],
                              [  6.            ,  12.538998289557,  71.753429999885],
                              [  6.            ,  15.000000000032,  71.753429999885],
                              [  6.            ,  17.461001710437,  71.753429999885],
                              [  6.            ,  19.922003420877,  71.753429999885],
                              [  6.            ,  10.077996579117,  73.174289999873],
                              [  6.            ,  12.538998289557,  73.174289999873],
                              [  6.            ,  15.000000000032,  73.174289999873],
                              [  6.            ,  17.461001710437,  73.174289999873],
                              [  6.            ,  19.922003420877,  73.174289999873],
                              [  6.            ,   7.903528101467,  73.339720038929],
                              [  6.            ,  22.096471898527,  73.339720038929],
                              [  6.            ,   8.847495723897,  73.884719999996],
                              [  6.            ,  11.308497434337,  73.884719999996],
                              [  6.            ,  13.769499144742,  73.884719999996],
                              [  6.            ,  16.230500855252,  73.884719999996],
                              [  6.            ,  18.691502565657,  73.884719999996],
                              [  6.            ,  21.152504276097,  73.884719999996],
                              [  6.            ,   8.847495723897,  75.305579999963],
                              [  6.            ,  11.308497434337,  75.305579999963],
                              [  6.            ,  13.769499144742,  75.305579999963],
                              [  6.            ,  16.230500855252,  75.305579999963],
                              [  6.            ,  18.691502565657,  75.305579999963],
                              [  6.            ,  21.152504276097,  75.305579999963],
                              [  6.            ,   7.903528101467,  75.850579960748],
                              [  6.            ,  22.096471898527,  75.850579960748],
                              [  6.            ,  10.077996579117,  76.016009999945],
                              [  6.            ,  12.538998289557,  76.016009999945],
                              [  6.            ,  15.000000000032,  76.016009999945],
                              [  6.            ,  17.461001710437,  76.016009999945],
                              [  6.            ,  19.922003420877,  76.016009999945],
                              [  6.            ,  10.077996579117,  77.436869999933],
                              [  6.            ,  12.538998289557,  77.436869999933],
                              [  6.            ,  15.000000000032,  77.436869999933],
                              [  6.            ,  17.461001710437,  77.436869999933],
                              [  6.            ,  19.922003420877,  77.436869999933],
                              [  6.            ,   7.903528101467,  77.602300038989],
                              [  6.            ,  22.096471898527,  77.602300038989],
                              [  6.            ,   8.847495723897,  78.147300000056],
                              [  6.            ,  11.308497434337,  78.147300000056],
                              [  6.            ,  13.769499144742,  78.147300000056],
                              [  6.            ,  16.230500855252,  78.147300000056],
                              [  6.            ,  18.691502565657,  78.147300000056],
                              [  6.            ,  21.152504276097,  78.147300000056],
                              [  6.            ,   8.847495723897,  79.568160000023],
                              [  6.            ,  11.308497434337,  79.568160000023],
                              [  6.            ,  13.769499144742,  79.568160000023],
                              [  6.            ,  16.230500855252,  79.568160000023],
                              [  6.            ,  18.691502565657,  79.568160000023],
                              [  6.            ,  21.152504276097,  79.568160000023],
                              [  6.            ,   7.903528101467,  80.113159960808],
                              [  6.            ,  22.096471898527,  80.113159960808],
                              [  6.            ,  10.077996579117,  80.278590000005],
                              [  6.            ,  12.538998289557,  80.278590000005],
                              [  6.            ,  15.000000000032,  80.278590000005],
                              [  6.            ,  17.461001710437,  80.278590000005],
                              [  6.            ,  19.922003420877,  80.278590000005]]*Angstrom


# Set up configuration
central_region = BulkConfiguration(
    bravais_lattice=central_region_lattice,
    elements=central_region_elements,
    cartesian_coordinates=central_region_coordinates
    )

VG=numpy.linspace(-2,2,9)
for vg in VG:
  # Add metallic region
  metallic_region_0 = BoxRegion(
    vg*Volt,
    xmin = 0.0*Angstrom, xmax = 0.5*Angstrom,
    ymin = 0.0*Angstrom, ymax = 30.0*Angstrom,
    zmin = 12.78*Angstrom, zmax = 68.29*Angstrom,
  )

  metallic_regions = [metallic_region_0]
  central_region.setMetallicRegions(metallic_regions)

# Add dielectric region
  dielectric_region_0 = BoxRegion(
    3.9,
    xmin = 0.5*Angstrom, xmax = 3.58*Angstrom,
    ymin = 0.0*Angstrom, ymax = 30.0*Angstrom,
    zmin = 12.78*Angstrom, zmax = 68.29*Angstrom,
  )

  dielectric_regions = [dielectric_region_0]
  central_region.setDielectricRegions(dielectric_regions)

  device_configuration = DeviceConfiguration(
    central_region,
    [left_electrode, right_electrode]
    )

# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------
#----------------------------------------
# Basis Set
#----------------------------------------
  basis_set = DFTBDirectory("cp2k/scc/")

#----------------------------------------
# Pair Potentials
#----------------------------------------
  pair_potentials = DFTBDirectory("cp2k/scc/")

#----------------------------------------
# Numerical Accuracy Settings
#----------------------------------------
  left_electrode_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  left_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=left_electrode_k_point_sampling,
    )

  right_electrode_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  right_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=right_electrode_k_point_sampling,
    )

  device_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  device_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=device_k_point_sampling,
    )

#----------------------------------------
# Iteration Control Settings
#----------------------------------------
  left_electrode_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

  right_electrode_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

  device_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

#----------------------------------------
# Poisson Solver Settings
#----------------------------------------
  left_electrode_poisson_solver = MultigridSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]]
    )

  right_electrode_poisson_solver = MultigridSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]]
    )

#----------------------------------------
# Electrode Calculators
#----------------------------------------
  left_electrode_calculator = SlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=left_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=left_electrode_iteration_control_parameters,
    poisson_solver=left_electrode_poisson_solver,
    )

  right_electrode_calculator = SlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=right_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=right_electrode_iteration_control_parameters,
    poisson_solver=right_electrode_poisson_solver,
    )

#----------------------------------------
# Device Calculator
#----------------------------------------
  calculator = DeviceSlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=device_numerical_accuracy_parameters,
    iteration_control_parameters=device_iteration_control_parameters,
    electrode_calculators=
        [left_electrode_calculator, right_electrode_calculator],
    )

  device_configuration.setCalculator(calculator)
  #nlprint(device_configuration)
  device_configuration.update()
  nlsave('Device_11-10AGNR_55_%s.nc'%vg, device_configuration)

# -------------------------------------------------------------
# Transmission Spectrum
# -------------------------------------------------------------
  kpoint_grid = MonkhorstPackGrid()

  transmission_spectrum = TransmissionSpectrum(
    configuration=device_configuration,
    energies=numpy.linspace(-1,1,101)*eV,
    kpoints=kpoint_grid,
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    self_energy_calculator=RecursionSelfEnergy(),
    )
  nlsave('Device_11-10AGNR_55_%s.nc'%vg, transmission_spectrum)
  nlprint(transmission_spectrum)

  T=[300]
#  T=numpy.linspace(250,350,11)
  for temp in T:
    temperature=temp*Kelvin
    conductance=transmission_spectrum.conductance(electrode_temperatures=(temperature,temperature))
    current=transmission_spectrum.current(electrode_temperatures=(temperature,temperature))
    if ( processIsMaster() ):
      print "Gate voltage = %s: Conductance = %s at T = %s"%(vg,conductance,temperature)
      print "Gate voltage = %s: Current = %s at T = %s"%(vg,current,temperature)

# -------------------------------------------------------------
# IV Curve
# -------------------------------------------------------------
  biases = [0.000000, 0.200000, 0.400000, 0.600000, 0.800000, 1.000000,
          1.200000, 1.400000, 1.600000, 1.800000, 2.000000]*Volt

  kpoint_grid = MonkhorstPackGrid()

  iv_curve = IVCurve(
    configuration=device_configuration,
    biases=biases,
    energies=numpy.linspace(-1,1,101)*eV,
    kpoints=kpoint_grid,
    self_energy_calculator=RecursionSelfEnergy(),
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    selfconsistent_configurations_filename_prefix=NoCheckpointHandler,
    log_filename_prefix=None
    )
  nlsave('Device_11-10AGNR_55_%s.nc'%vg, iv_curve)
  nlprint(iv_curve)

  biases = [-0.200000, -0.400000, -0.600000, -0.800000, -1.000000,
          -1.200000, -1.400000, -1.600000, -1.800000, -2.000000]*Volt

  kpoint_grid = MonkhorstPackGrid()

  iv_curve = IVCurve(
    configuration=device_configuration,
    biases=biases,
    energies=numpy.linspace(-1,1,101)*eV,
    kpoints=kpoint_grid,
    self_energy_calculator=RecursionSelfEnergy(),
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    selfconsistent_configurations_filename_prefix=NoCheckpointHandler,
    log_filename_prefix=None
    )
  nlsave('Device_11-10AGNR_55_%s.nc'%vg, iv_curve)
  nlprint(iv_curve)