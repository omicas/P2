# -*- coding: utf-8 -*-
# -------------------------------------------------------------
# Two-probe Configuration
# -------------------------------------------------------------

# -------------------------------------------------------------
# Left Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 35.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 8.52515999999]*Angstrom
left_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
left_electrode_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon]

# Define coordinates
left_electrode_coordinates = [[  7.38818181174 ,  12.57799657912 ,   0.71043       ],
                              [  7.38818181174 ,  15.03899828956 ,   0.71043       ],
                              [  7.38818181174 ,  17.500000000035,   0.71043       ],
                              [  7.38818181174 ,  19.96100171044 ,   0.71043       ],
                              [  7.38818181174 ,  22.42200342088 ,   0.71043       ],
                              [  7.38818181174 ,  10.40352810147 ,   0.875860039163],
                              [  7.38818181174 ,  24.59647189853 ,   0.875860039163],
                              [  7.38818181174 ,  11.3474957239  ,   1.420859999999],
                              [  7.38818181174 ,  13.80849743434 ,   1.420859999999],
                              [  7.38818181174 ,  16.269499144745,   1.420859999999],
                              [  7.38818181174 ,  18.730500855255,   1.420859999999],
                              [  7.38818181174 ,  21.19150256566 ,   1.420859999999],
                              [  7.38818181174 ,  23.6525042761  ,   1.420859999999],
                              [  7.38818181174 ,  11.3474957239  ,   2.841719999998],
                              [  7.38818181174 ,  13.80849743434 ,   2.841719999998],
                              [  7.38818181174 ,  16.269499144745,   2.841719999998],
                              [  7.38818181174 ,  18.730500855255,   2.841719999998],
                              [  7.38818181174 ,  21.19150256566 ,   2.841719999998],
                              [  7.38818181174 ,  23.6525042761  ,   2.841719999998],
                              [  7.38818181174 ,  10.40352810147 ,   3.386719960945],
                              [  7.38818181174 ,  24.59647189853 ,   3.386719960945],
                              [  7.38818181174 ,  12.57799657912 ,   3.552149999998],
                              [  7.38818181174 ,  15.03899828956 ,   3.552149999998],
                              [  7.38818181174 ,  17.500000000035,   3.552149999998],
                              [  7.38818181174 ,  19.96100171044 ,   3.552149999998],
                              [  7.38818181174 ,  22.42200342088 ,   3.552149999998],
                              [  7.38818181174 ,  12.57799657912 ,   4.973009999997],
                              [  7.38818181174 ,  15.03899828956 ,   4.973009999997],
                              [  7.38818181174 ,  17.500000000035,   4.973009999997],
                              [  7.38818181174 ,  19.96100171044 ,   4.973009999997],
                              [  7.38818181174 ,  22.42200342088 ,   4.973009999997],
                              [  7.38818181174 ,  10.40352810147 ,   5.13844003916 ],
                              [  7.38818181174 ,  24.59647189853 ,   5.13844003916 ],
                              [  7.38818181174 ,  11.3474957239  ,   5.683439999996],
                              [  7.38818181174 ,  13.80849743434 ,   5.683439999996],
                              [  7.38818181174 ,  16.269499144745,   5.683439999996],
                              [  7.38818181174 ,  18.730500855255,   5.683439999996],
                              [  7.38818181174 ,  21.19150256566 ,   5.683439999996],
                              [  7.38818181174 ,  23.6525042761  ,   5.683439999996],
                              [  7.38818181174 ,  11.3474957239  ,   7.104299999995],
                              [  7.38818181174 ,  13.80849743434 ,   7.104299999995],
                              [  7.38818181174 ,  16.269499144745,   7.104299999995],
                              [  7.38818181174 ,  18.730500855255,   7.104299999995],
                              [  7.38818181174 ,  21.19150256566 ,   7.104299999995],
                              [  7.38818181174 ,  23.6525042761  ,   7.104299999995],
                              [  7.38818181174 ,  10.40352810147 ,   7.649299960887],
                              [  7.38818181174 ,  24.59647189853 ,   7.649299960887],
                              [  7.38818181174 ,  12.57799657912 ,   7.814729999995],
                              [  7.38818181174 ,  15.03899828956 ,   7.814729999995],
                              [  7.38818181174 ,  17.500000000035,   7.814729999995],
                              [  7.38818181174 ,  19.96100171044 ,   7.814729999995],
                              [  7.38818181174 ,  22.42200342088 ,   7.814729999995]]*Angstrom

# Set up configuration
left_electrode = BulkConfiguration(
    bravais_lattice=left_electrode_lattice,
    elements=left_electrode_elements,
    cartesian_coordinates=left_electrode_coordinates
    )

# -------------------------------------------------------------
# Right Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 35.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 8.52515999999]*Angstrom
right_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
right_electrode_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                            Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                            Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                            Carbon, Carbon, Carbon, Carbon]

# Define coordinates
right_electrode_coordinates = [[  7.38818181174 ,  12.57799657912 ,   0.710430000027],
                               [  7.38818181174 ,  15.03899828956 ,   0.710430000027],
                               [  7.38818181174 ,  17.500000000035,   0.710430000027],
                               [  7.38818181174 ,  19.96100171044 ,   0.710430000027],
                               [  7.38818181174 ,  22.42200342088 ,   0.710430000027],
                               [  7.38818181174 ,  10.40352810147 ,   0.87586003908 ],
                               [  7.38818181174 ,  24.59647189853 ,   0.87586003908 ],
                               [  7.38818181174 ,  11.3474957239  ,   1.420859999971],
                               [  7.38818181174 ,  13.80849743434 ,   1.420859999971],
                               [  7.38818181174 ,  16.269499144745,   1.420859999971],
                               [  7.38818181174 ,  18.730500855255,   1.420859999971],
                               [  7.38818181174 ,  21.19150256566 ,   1.420859999971],
                               [  7.38818181174 ,  23.6525042761  ,   1.420859999971],
                               [  7.38818181174 ,  11.3474957239  ,   2.841719999915],
                               [  7.38818181174 ,  13.80849743434 ,   2.841719999915],
                               [  7.38818181174 ,  16.269499144745,   2.841719999915],
                               [  7.38818181174 ,  18.730500855255,   2.841719999915],
                               [  7.38818181174 ,  21.19150256566 ,   2.841719999915],
                               [  7.38818181174 ,  23.6525042761  ,   2.841719999915],
                               [  7.38818181174 ,  10.40352810147 ,   3.386719960806],
                               [  7.38818181174 ,  24.59647189853 ,   3.386719960806],
                               [  7.38818181174 ,  12.57799657912 ,   3.55214999997 ],
                               [  7.38818181174 ,  15.03899828956 ,   3.55214999997 ],
                               [  7.38818181174 ,  17.500000000035,   3.55214999997 ],
                               [  7.38818181174 ,  19.96100171044 ,   3.55214999997 ],
                               [  7.38818181174 ,  22.42200342088 ,   3.55214999997 ],
                               [  7.38818181174 ,  12.57799657912 ,   4.973009999914],
                               [  7.38818181174 ,  15.03899828956 ,   4.973009999914],
                               [  7.38818181174 ,  17.500000000035,   4.973009999914],
                               [  7.38818181174 ,  19.96100171044 ,   4.973009999914],
                               [  7.38818181174 ,  22.42200342088 ,   4.973009999914],
                               [  7.38818181174 ,  10.40352810147 ,   5.138440039077],
                               [  7.38818181174 ,  24.59647189853 ,   5.138440039077],
                               [  7.38818181174 ,  11.3474957239  ,   5.683439999968],
                               [  7.38818181174 ,  13.80849743434 ,   5.683439999968],
                               [  7.38818181174 ,  16.269499144745,   5.683439999968],
                               [  7.38818181174 ,  18.730500855255,   5.683439999968],
                               [  7.38818181174 ,  21.19150256566 ,   5.683439999968],
                               [  7.38818181174 ,  23.6525042761  ,   5.683439999968],
                               [  7.38818181174 ,  11.3474957239  ,   7.104300000023],
                               [  7.38818181174 ,  13.80849743434 ,   7.104300000023],
                               [  7.38818181174 ,  16.269499144745,   7.104300000023],
                               [  7.38818181174 ,  18.730500855255,   7.104300000023],
                               [  7.38818181174 ,  21.19150256566 ,   7.104300000023],
                               [  7.38818181174 ,  23.6525042761  ,   7.104300000023],
                               [  7.38818181174 ,  10.40352810147 ,   7.649299960803],
                               [  7.38818181174 ,  24.59647189853 ,   7.649299960803],
                               [  7.38818181174 ,  12.57799657912 ,   7.814729999967],
                               [  7.38818181174 ,  15.03899828956 ,   7.814729999967],
                               [  7.38818181174 ,  17.500000000035,   7.814729999967],
                               [  7.38818181174 ,  19.96100171044 ,   7.814729999967],
                               [  7.38818181174 ,  22.42200342088 ,   7.814729999967]]*Angstrom

# Set up configuration
right_electrode = BulkConfiguration(
    bravais_lattice=right_electrode_lattice,
    elements=right_electrode_elements,
    cartesian_coordinates=right_electrode_coordinates
    )

# -------------------------------------------------------------
# Central Region
# -------------------------------------------------------------

# Set up lattice
vector_a = [30.0, 0.0, 0.0]*Angstrom
vector_b = [0.0, 35.0, 0.0]*Angstrom
vector_c = [0.0, 0.0, 72.4638600001]*Angstrom
central_region_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
central_region_elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen, Hydrogen, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Hydrogen, Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon,
                           Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Hydrogen,
                           Hydrogen, Carbon, Carbon, Carbon, Carbon, Carbon]

# Define coordinates
central_region_coordinates = [[  7.38818181174 ,  12.57799657912 ,   0.710429999983],
                              [  7.38818181174 ,  15.03899828956 ,   0.710429999983],
                              [  7.38818181174 ,  17.500000000035,   0.710429999983],
                              [  7.38818181174 ,  19.96100171044 ,   0.710429999983],
                              [  7.38818181174 ,  22.42200342088 ,   0.710429999983],
                              [  7.38818181174 ,  10.40352810147 ,   0.875860039159],
                              [  7.38818181174 ,  24.59647189853 ,   0.875860039159],
                              [  7.38818181174 ,  11.3474957239  ,   1.420860000038],
                              [  7.38818181174 ,  13.80849743434 ,   1.420860000038],
                              [  7.38818181174 ,  16.269499144745,   1.420860000038],
                              [  7.38818181174 ,  18.730500855255,   1.420860000038],
                              [  7.38818181174 ,  21.19150256566 ,   1.420860000038],
                              [  7.38818181174 ,  23.6525042761  ,   1.420860000038],
                              [  7.38818181174 ,  11.3474957239  ,   2.841720000004],
                              [  7.38818181174 ,  13.80849743434 ,   2.841720000004],
                              [  7.38818181174 ,  16.269499144745,   2.841720000004],
                              [  7.38818181174 ,  18.730500855255,   2.841720000004],
                              [  7.38818181174 ,  21.19150256566 ,   2.841720000004],
                              [  7.38818181174 ,  23.6525042761  ,   2.841720000004],
                              [  7.38818181174 ,  10.40352810147 ,   3.386719960955],
                              [  7.38818181174 ,  24.59647189853 ,   3.386719960955],
                              [  7.38818181174 ,  12.57799657912 ,   3.552149999986],
                              [  7.38818181174 ,  15.03899828956 ,   3.552149999986],
                              [  7.38818181174 ,  17.500000000035,   3.552149999986],
                              [  7.38818181174 ,  19.96100171044 ,   3.552149999986],
                              [  7.38818181174 ,  22.42200342088 ,   3.552149999986],
                              [  7.38818181174 ,  12.57799657912 ,   4.973009999952],
                              [  7.38818181174 ,  15.03899828956 ,   4.973009999952],
                              [  7.38818181174 ,  17.500000000035,   4.973009999952],
                              [  7.38818181174 ,  19.96100171044 ,   4.973009999952],
                              [  7.38818181174 ,  22.42200342088 ,   4.973009999952],
                              [  7.38818181174 ,  10.40352810147 ,   5.138440039128],
                              [  7.38818181174 ,  24.59647189853 ,   5.138440039128],
                              [  7.38818181174 ,  11.3474957239  ,   5.683440000007],
                              [  7.38818181174 ,  13.80849743434 ,   5.683440000007],
                              [  7.38818181174 ,  16.269499144745,   5.683440000007],
                              [  7.38818181174 ,  18.730500855255,   5.683440000007],
                              [  7.38818181174 ,  21.19150256566 ,   5.683440000007],
                              [  7.38818181174 ,  23.6525042761  ,   5.683440000007],
                              [  7.38818181174 ,  11.3474957239  ,   7.104299999973],
                              [  7.38818181174 ,  13.80849743434 ,   7.104299999973],
                              [  7.38818181174 ,  16.269499144745,   7.104299999973],
                              [  7.38818181174 ,  18.730500855255,   7.104299999973],
                              [  7.38818181174 ,  21.19150256566 ,   7.104299999973],
                              [  7.38818181174 ,  23.6525042761  ,   7.104299999973],
                              [  7.38818181174 ,  10.40352810147 ,   7.649299960852],
                              [  7.38818181174 ,  24.59647189853 ,   7.649299960852],
                              [  7.38818181174 ,  12.57799657912 ,   7.814730000028],
                              [  7.38818181174 ,  15.03899828956 ,   7.814730000028],
                              [  7.38818181174 ,  17.500000000035,   7.814730000028],
                              [  7.38818181174 ,  19.96100171044 ,   7.814730000028],
                              [  7.38818181174 ,  22.42200342088 ,   7.814730000028],
                              [  7.38818181174 ,  12.57799657912 ,   9.235589999993],
                              [  7.38818181174 ,  15.03899828956 ,   9.235589999993],
                              [  7.38818181174 ,  17.500000000035,   9.235589999993],
                              [  7.38818181174 ,  19.96100171044 ,   9.235589999993],
                              [  7.38818181174 ,  22.42200342088 ,   9.235589999993],
                              [  7.38818181174 ,  10.40352810147 ,   9.401020039025],
                              [  7.38818181174 ,  24.59647189853 ,   9.401020039025],
                              [  7.38818181174 ,  11.3474957239  ,   9.946020000049],
                              [  7.38818181174 ,  13.80849743434 ,   9.946020000049],
                              [  7.38818181174 ,  16.269499144745,   9.946020000049],
                              [  7.38818181174 ,  18.730500855255,   9.946020000049],
                              [  7.38818181174 ,  21.19150256566 ,   9.946020000049],
                              [  7.38818181174 ,  23.6525042761  ,   9.946020000049],
                              [  7.38818181174 ,  11.3474957239  ,  11.366880000014],
                              [  7.38818181174 ,  13.80849743434 ,  11.366880000014],
                              [  7.38818181174 ,  16.269499144745,  11.366880000014],
                              [  7.38818181174 ,  18.730500855255,  11.366880000014],
                              [  7.38818181174 ,  21.19150256566 ,  11.366880000014],
                              [  7.38818181174 ,  23.6525042761  ,  11.366880000014],
                              [  7.38818181174 ,  10.40352810147 ,  11.911879960966],
                              [  7.38818181174 ,  24.59647189853 ,  11.911879960966],
                              [  7.38818181174 ,  12.57799657912 ,  12.077309999997],
                              [  7.38818181174 ,  15.03899828956 ,  12.077309999997],
                              [  7.38818181174 ,  17.500000000035,  12.077309999997],
                              [  7.38818181174 ,  19.96100171044 ,  12.077309999997],
                              [  7.38818181174 ,  22.42200342088 ,  12.077309999997],
                              [  7.38818181174 ,  12.57799657912 ,  13.498169999963],
                              [  7.38818181174 ,  15.03899828956 ,  13.498169999963],
                              [  7.38818181174 ,  17.500000000035,  13.498169999963],
                              [  7.38818181174 ,  19.96100171044 ,  13.498169999963],
                              [  7.38818181174 ,  22.42200342088 ,  13.498169999963],
                              [  7.38818181174 ,  11.63402895669 ,  14.043169960841],
                              [  7.38818181174 ,  23.36597104331 ,  14.043169960841],
                              [  7.38818181174 ,  13.80849743434 ,  14.208599999945],
                              [  7.38818181174 ,  16.269499144745,  14.208599999945],
                              [  7.38818181174 ,  18.730500855255,  14.208599999945],
                              [  7.38818181174 ,  21.19150256566 ,  14.208599999945],
                              [  7.38818181174 ,  13.80849743434 ,  15.629459999983],
                              [  7.38818181174 ,  16.269499144745,  15.629459999983],
                              [  7.38818181174 ,  18.730500855255,  15.629459999983],
                              [  7.38818181174 ,  21.19150256566 ,  15.629459999983],
                              [  7.38818181174 ,  11.63402895669 ,  15.794890039015],
                              [  7.38818181174 ,  23.36597104331 ,  15.794890039015],
                              [  7.38818181174 ,  12.57799657912 ,  16.339890000039],
                              [  7.38818181174 ,  15.03899828956 ,  16.339890000039],
                              [  7.38818181174 ,  17.500000000035,  16.339890000039],
                              [  7.38818181174 ,  19.96100171044 ,  16.339890000039],
                              [  7.38818181174 ,  22.42200342088 ,  16.339890000039],
                              [  7.38818181174 ,  12.57799657912 ,  17.760750000004],
                              [  7.38818181174 ,  15.03899828956 ,  17.760750000004],
                              [  7.38818181174 ,  17.500000000035,  17.760750000004],
                              [  7.38818181174 ,  19.96100171044 ,  17.760750000004],
                              [  7.38818181174 ,  22.42200342088 ,  17.760750000004],
                              [  7.38818181174 ,  11.63402895669 ,  18.305749960955],
                              [  7.38818181174 ,  23.36597104331 ,  18.305749960955],
                              [  7.38818181174 ,  13.80849743434 ,  18.471179999987],
                              [  7.38818181174 ,  16.269499144745,  18.471179999987],
                              [  7.38818181174 ,  18.730500855255,  18.471179999987],
                              [  7.38818181174 ,  21.19150256566 ,  18.471179999987],
                              [  7.38818181174 ,  13.80849743434 ,  19.892039999952],
                              [  7.38818181174 ,  16.269499144745,  19.892039999952],
                              [  7.38818181174 ,  18.730500855255,  19.892039999952],
                              [  7.38818181174 ,  21.19150256566 ,  19.892039999952],
                              [  7.38818181174 ,  11.63402895669 ,  20.057470039129],
                              [  7.38818181174 ,  23.36597104331 ,  20.057470039129],
                              [  7.38818181174 ,  12.57799657912 ,  20.602469999935],
                              [  7.38818181174 ,  15.03899828956 ,  20.602469999935],
                              [  7.38818181174 ,  17.500000000035,  20.602469999935],
                              [  7.38818181174 ,  19.96100171044 ,  20.602469999935],
                              [  7.38818181174 ,  22.42200342088 ,  20.602469999935],
                              [  7.38818181174 ,  12.57799657912 ,  22.023329999973],
                              [  7.38818181174 ,  15.03899828956 ,  22.023329999973],
                              [  7.38818181174 ,  17.500000000035,  22.023329999973],
                              [  7.38818181174 ,  19.96100171044 ,  22.023329999973],
                              [  7.38818181174 ,  22.42200342088 ,  22.023329999973],
                              [  7.38818181174 ,  11.63402895669 ,  22.568329960852],
                              [  7.38818181174 ,  23.36597104331 ,  22.568329960852],
                              [  7.38818181174 ,  13.80849743434 ,  22.733760000028],
                              [  7.38818181174 ,  16.269499144745,  22.733760000028],
                              [  7.38818181174 ,  18.730500855255,  22.733760000028],
                              [  7.38818181174 ,  21.19150256566 ,  22.733760000028],
                              [  7.38818181174 ,  13.80849743434 ,  24.154619999994],
                              [  7.38818181174 ,  16.269499144745,  24.154619999994],
                              [  7.38818181174 ,  18.730500855255,  24.154619999994],
                              [  7.38818181174 ,  21.19150256566 ,  24.154619999994],
                              [  7.38818181174 ,  11.63402895669 ,  24.32005003917 ],
                              [  7.38818181174 ,  23.36597104331 ,  24.32005003917 ],
                              [  7.38818181174 ,  12.57799657912 ,  24.865050000049],
                              [  7.38818181174 ,  15.03899828956 ,  24.865050000049],
                              [  7.38818181174 ,  17.500000000035,  24.865050000049],
                              [  7.38818181174 ,  19.96100171044 ,  24.865050000049],
                              [  7.38818181174 ,  22.42200342088 ,  24.865050000049],
                              [  7.38818181174 ,  12.57799657912 ,  26.285910000087],
                              [  7.38818181174 ,  15.03899828956 ,  26.285910000087],
                              [  7.38818181174 ,  17.500000000035,  26.285910000087],
                              [  7.38818181174 ,  19.96100171044 ,  26.285910000087],
                              [  7.38818181174 ,  22.42200342088 ,  26.285910000087],
                              [  7.38818181174 ,  11.63402895669 ,  26.830909960894],
                              [  7.38818181174 ,  23.36597104331 ,  26.830909960894],
                              [  7.38818181174 ,  13.80849743434 ,  26.996339999925],
                              [  7.38818181174 ,  16.269499144745,  26.996339999925],
                              [  7.38818181174 ,  18.730500855255,  26.996339999925],
                              [  7.38818181174 ,  21.19150256566 ,  26.996339999925],
                              [  7.38818181174 ,  13.80849743434 ,  28.417199999963],
                              [  7.38818181174 ,  16.269499144745,  28.417199999963],
                              [  7.38818181174 ,  18.730500855255,  28.417199999963],
                              [  7.38818181174 ,  21.19150256566 ,  28.417199999963],
                              [  7.38818181174 ,  11.63402895669 ,  28.582630039067],
                              [  7.38818181174 ,  23.36597104331 ,  28.582630039067],
                              [  7.38818181174 ,  12.57799657912 ,  29.127630000018],
                              [  7.38818181174 ,  15.03899828956 ,  29.127630000018],
                              [  7.38818181174 ,  17.500000000035,  29.127630000018],
                              [  7.38818181174 ,  19.96100171044 ,  29.127630000018],
                              [  7.38818181174 ,  22.42200342088 ,  29.127630000018],
                              [  7.38818181174 ,  12.57799657912 ,  30.548489999984],
                              [  7.38818181174 ,  15.03899828956 ,  30.548489999984],
                              [  7.38818181174 ,  17.500000000035,  30.548489999984],
                              [  7.38818181174 ,  19.96100171044 ,  30.548489999984],
                              [  7.38818181174 ,  22.42200342088 ,  30.548489999984],
                              [  7.38818181174 ,  11.63402895669 ,  31.093489960935],
                              [  7.38818181174 ,  23.36597104331 ,  31.093489960935],
                              [  7.38818181174 ,  13.80849743434 ,  31.258920000039],
                              [  7.38818181174 ,  16.269499144745,  31.258920000039],
                              [  7.38818181174 ,  18.730500855255,  31.258920000039],
                              [  7.38818181174 ,  21.19150256566 ,  31.258920000039],
                              [  7.38818181174 ,  13.80849743434 ,  32.679780000077],
                              [  7.38818181174 ,  16.269499144745,  32.679780000077],
                              [  7.38818181174 ,  18.730500855255,  32.679780000077],
                              [  7.38818181174 ,  21.19150256566 ,  32.679780000077],
                              [  7.38818181174 ,  11.63402895669 ,  32.845210039109],
                              [  7.38818181174 ,  23.36597104331 ,  32.845210039109],
                              [  7.38818181174 ,  12.57799657912 ,  33.390209999915],
                              [  7.38818181174 ,  15.03899828956 ,  33.390209999915],
                              [  7.38818181174 ,  17.500000000035,  33.390209999915],
                              [  7.38818181174 ,  19.96100171044 ,  33.390209999915],
                              [  7.38818181174 ,  22.42200342088 ,  33.390209999915],
                              [  7.38818181174 ,  12.57799657912 ,  34.811069999953],
                              [  7.38818181174 ,  15.03899828956 ,  34.811069999953],
                              [  7.38818181174 ,  17.500000000035,  34.811069999953],
                              [  7.38818181174 ,  19.96100171044 ,  34.811069999953],
                              [  7.38818181174 ,  22.42200342088 ,  34.811069999953],
                              [  7.38818181174 ,  11.63402895669 ,  35.356069960832],
                              [  7.38818181174 ,  23.36597104331 ,  35.356069960832],
                              [  7.38818181174 ,  13.80849743434 ,  35.521500000008],
                              [  7.38818181174 ,  16.269499144745,  35.521500000008],
                              [  7.38818181174 ,  18.730500855255,  35.521500000008],
                              [  7.38818181174 ,  21.19150256566 ,  35.521500000008],
                              [  7.38818181174 ,  13.80849743434 ,  36.942359999974],
                              [  7.38818181174 ,  16.269499144745,  36.942359999974],
                              [  7.38818181174 ,  18.730500855255,  36.942359999974],
                              [  7.38818181174 ,  21.19150256566 ,  36.942359999974],
                              [  7.38818181174 ,  11.63402895669 ,  37.10779003915 ],
                              [  7.38818181174 ,  23.36597104331 ,  37.10779003915 ],
                              [  7.38818181174 ,  12.57799657912 ,  37.652790000029],
                              [  7.38818181174 ,  15.03899828956 ,  37.652790000029],
                              [  7.38818181174 ,  17.500000000035,  37.652790000029],
                              [  7.38818181174 ,  19.96100171044 ,  37.652790000029],
                              [  7.38818181174 ,  22.42200342088 ,  37.652790000029],
                              [  7.38818181174 ,  12.57799657912 ,  39.073650000067],
                              [  7.38818181174 ,  15.03899828956 ,  39.073650000067],
                              [  7.38818181174 ,  17.500000000035,  39.073650000067],
                              [  7.38818181174 ,  19.96100171044 ,  39.073650000067],
                              [  7.38818181174 ,  22.42200342088 ,  39.073650000067],
                              [  7.38818181174 ,  11.63402895669 ,  39.618649960873],
                              [  7.38818181174 ,  23.36597104331 ,  39.618649960873],
                              [  7.38818181174 ,  13.80849743434 ,  39.784079999905],
                              [  7.38818181174 ,  16.269499144745,  39.784079999905],
                              [  7.38818181174 ,  18.730500855255,  39.784079999905],
                              [  7.38818181174 ,  21.19150256566 ,  39.784079999905],
                              [  7.38818181174 ,  13.80849743434 ,  41.204940000015],
                              [  7.38818181174 ,  16.269499144745,  41.204940000015],
                              [  7.38818181174 ,  18.730500855255,  41.204940000015],
                              [  7.38818181174 ,  21.19150256566 ,  41.204940000015],
                              [  7.38818181174 ,  11.63402895669 ,  41.370370039047],
                              [  7.38818181174 ,  23.36597104331 ,  41.370370039047],
                              [  7.38818181174 ,  12.57799657912 ,  41.915369999998],
                              [  7.38818181174 ,  15.03899828956 ,  41.915369999998],
                              [  7.38818181174 ,  17.500000000035,  41.915369999998],
                              [  7.38818181174 ,  19.96100171044 ,  41.915369999998],
                              [  7.38818181174 ,  22.42200342088 ,  41.915369999998],
                              [  7.38818181174 ,  12.57799657912 ,  43.336229999964],
                              [  7.38818181174 ,  15.03899828956 ,  43.336229999964],
                              [  7.38818181174 ,  17.500000000035,  43.336229999964],
                              [  7.38818181174 ,  19.96100171044 ,  43.336229999964],
                              [  7.38818181174 ,  22.42200342088 ,  43.336229999964],
                              [  7.38818181174 ,  11.63402895669 ,  43.881229960987],
                              [  7.38818181174 ,  23.36597104331 ,  43.881229960987],
                              [  7.38818181174 ,  13.80849743434 ,  44.046660000019],
                              [  7.38818181174 ,  16.269499144745,  44.046660000019],
                              [  7.38818181174 ,  18.730500855255,  44.046660000019],
                              [  7.38818181174 ,  21.19150256566 ,  44.046660000019],
                              [  7.38818181174 ,  13.80849743434 ,  45.467520000057],
                              [  7.38818181174 ,  16.269499144745,  45.467520000057],
                              [  7.38818181174 ,  18.730500855255,  45.467520000057],
                              [  7.38818181174 ,  21.19150256566 ,  45.467520000057],
                              [  7.38818181174 ,  11.63402895669 ,  45.632950039161],
                              [  7.38818181174 ,  23.36597104331 ,  45.632950039161],
                              [  7.38818181174 ,  12.57799657912 ,  46.17795000004 ],
                              [  7.38818181174 ,  15.03899828956 ,  46.17795000004 ],
                              [  7.38818181174 ,  17.500000000035,  46.17795000004 ],
                              [  7.38818181174 ,  19.96100171044 ,  46.17795000004 ],
                              [  7.38818181174 ,  22.42200342088 ,  46.17795000004 ],
                              [  7.38818181174 ,  12.57799657912 ,  47.598810000005],
                              [  7.38818181174 ,  15.03899828956 ,  47.598810000005],
                              [  7.38818181174 ,  17.500000000035,  47.598810000005],
                              [  7.38818181174 ,  19.96100171044 ,  47.598810000005],
                              [  7.38818181174 ,  22.42200342088 ,  47.598810000005],
                              [  7.38818181174 ,  11.63402895669 ,  48.143809960884],
                              [  7.38818181174 ,  23.36597104331 ,  48.143809960884],
                              [  7.38818181174 ,  13.80849743434 ,  48.309239999988],
                              [  7.38818181174 ,  16.269499144745,  48.309239999988],
                              [  7.38818181174 ,  18.730500855255,  48.309239999988],
                              [  7.38818181174 ,  21.19150256566 ,  48.309239999988],
                              [  7.38818181174 ,  13.80849743434 ,  49.730099999954],
                              [  7.38818181174 ,  16.269499144745,  49.730099999954],
                              [  7.38818181174 ,  18.730500855255,  49.730099999954],
                              [  7.38818181174 ,  21.19150256566 ,  49.730099999954],
                              [  7.38818181174 ,  11.63402895669 ,  49.895530039057],
                              [  7.38818181174 ,  23.36597104331 ,  49.895530039057],
                              [  7.38818181174 ,  12.57799657912 ,  50.440530000009],
                              [  7.38818181174 ,  15.03899828956 ,  50.440530000009],
                              [  7.38818181174 ,  17.500000000035,  50.440530000009],
                              [  7.38818181174 ,  19.96100171044 ,  50.440530000009],
                              [  7.38818181174 ,  22.42200342088 ,  50.440530000009],
                              [  7.38818181174 ,  12.57799657912 ,  51.861389999974],
                              [  7.38818181174 ,  15.03899828956 ,  51.861389999974],
                              [  7.38818181174 ,  17.500000000035,  51.861389999974],
                              [  7.38818181174 ,  19.96100171044 ,  51.861389999974],
                              [  7.38818181174 ,  22.42200342088 ,  51.861389999974],
                              [  7.38818181174 ,  11.63402895669 ,  52.406389960853],
                              [  7.38818181174 ,  23.36597104331 ,  52.406389960853],
                              [  7.38818181174 ,  13.80849743434 ,  52.57182000003 ],
                              [  7.38818181174 ,  16.269499144745,  52.57182000003 ],
                              [  7.38818181174 ,  18.730500855255,  52.57182000003 ],
                              [  7.38818181174 ,  21.19150256566 ,  52.57182000003 ],
                              [  7.38818181174 ,  13.80849743434 ,  53.992679999995],
                              [  7.38818181174 ,  16.269499144745,  53.992679999995],
                              [  7.38818181174 ,  18.730500855255,  53.992679999995],
                              [  7.38818181174 ,  21.19150256566 ,  53.992679999995],
                              [  7.38818181174 ,  11.63402895669 ,  54.158110039171],
                              [  7.38818181174 ,  23.36597104331 ,  54.158110039171],
                              [  7.38818181174 ,  12.57799657912 ,  54.70311000005 ],
                              [  7.38818181174 ,  15.03899828956 ,  54.70311000005 ],
                              [  7.38818181174 ,  17.500000000035,  54.70311000005 ],
                              [  7.38818181174 ,  19.96100171044 ,  54.70311000005 ],
                              [  7.38818181174 ,  22.42200342088 ,  54.70311000005 ],
                              [  7.38818181174 ,  12.57799657912 ,  56.123970000016],
                              [  7.38818181174 ,  15.03899828956 ,  56.123970000016],
                              [  7.38818181174 ,  17.500000000035,  56.123970000016],
                              [  7.38818181174 ,  19.96100171044 ,  56.123970000016],
                              [  7.38818181174 ,  22.42200342088 ,  56.123970000016],
                              [  7.38818181174 ,  11.63402895669 ,  56.668969960967],
                              [  7.38818181174 ,  23.36597104331 ,  56.668969960967],
                              [  7.38818181174 ,  13.80849743434 ,  56.834399999999],
                              [  7.38818181174 ,  16.269499144745,  56.834399999999],
                              [  7.38818181174 ,  18.730500855255,  56.834399999999],
                              [  7.38818181174 ,  21.19150256566 ,  56.834399999999],
                              [  7.38818181174 ,  13.80849743434 ,  58.255259999964],
                              [  7.38818181174 ,  16.269499144745,  58.255259999964],
                              [  7.38818181174 ,  18.730500855255,  58.255259999964],
                              [  7.38818181174 ,  21.19150256566 ,  58.255259999964],
                              [  7.38818181174 ,  11.63402895669 ,  58.420690039141],
                              [  7.38818181174 ,  23.36597104331 ,  58.420690039141],
                              [  7.38818181174 ,  12.57799657912 ,  58.965690000019],
                              [  7.38818181174 ,  15.03899828956 ,  58.965690000019],
                              [  7.38818181174 ,  17.500000000035,  58.965690000019],
                              [  7.38818181174 ,  19.96100171044 ,  58.965690000019],
                              [  7.38818181174 ,  22.42200342088 ,  58.965690000019],
                              [  7.38818181174 ,  12.57799657912 ,  60.386549999985],
                              [  7.38818181174 ,  15.03899828956 ,  60.386549999985],
                              [  7.38818181174 ,  17.500000000035,  60.386549999985],
                              [  7.38818181174 ,  19.96100171044 ,  60.386549999985],
                              [  7.38818181174 ,  22.42200342088 ,  60.386549999985],
                              [  7.38818181174 ,  10.40352810147 ,  60.551980039016],
                              [  7.38818181174 ,  24.59647189853 ,  60.551980039016],
                              [  7.38818181174 ,  11.3474957239  ,  61.09698000004 ],
                              [  7.38818181174 ,  13.80849743434 ,  61.09698000004 ],
                              [  7.38818181174 ,  16.269499144745,  61.09698000004 ],
                              [  7.38818181174 ,  18.730500855255,  61.09698000004 ],
                              [  7.38818181174 ,  21.19150256566 ,  61.09698000004 ],
                              [  7.38818181174 ,  23.6525042761  ,  61.09698000004 ],
                              [  7.38818181174 ,  11.3474957239  ,  62.517840000006],
                              [  7.38818181174 ,  13.80849743434 ,  62.517840000006],
                              [  7.38818181174 ,  16.269499144745,  62.517840000006],
                              [  7.38818181174 ,  18.730500855255,  62.517840000006],
                              [  7.38818181174 ,  21.19150256566 ,  62.517840000006],
                              [  7.38818181174 ,  23.6525042761  ,  62.517840000006],
                              [  7.38818181174 ,  10.40352810147 ,  63.062839960957],
                              [  7.38818181174 ,  24.59647189853 ,  63.062839960957],
                              [  7.38818181174 ,  12.57799657912 ,  63.228269999989],
                              [  7.38818181174 ,  15.03899828956 ,  63.228269999989],
                              [  7.38818181174 ,  17.500000000035,  63.228269999989],
                              [  7.38818181174 ,  19.96100171044 ,  63.228269999989],
                              [  7.38818181174 ,  22.42200342088 ,  63.228269999989],
                              [  7.38818181174 ,  12.57799657912 ,  64.649130000099],
                              [  7.38818181174 ,  15.03899828956 ,  64.649130000099],
                              [  7.38818181174 ,  17.500000000035,  64.649130000099],
                              [  7.38818181174 ,  19.96100171044 ,  64.649130000099],
                              [  7.38818181174 ,  22.42200342088 ,  64.649130000099],
                              [  7.38818181174 ,  10.40352810147 ,  64.81456003913 ],
                              [  7.38818181174 ,  24.59647189853 ,  64.81456003913 ],
                              [  7.38818181174 ,  11.3474957239  ,  65.359560000009],
                              [  7.38818181174 ,  13.80849743434 ,  65.359560000009],
                              [  7.38818181174 ,  16.269499144745,  65.359560000009],
                              [  7.38818181174 ,  18.730500855255,  65.359560000009],
                              [  7.38818181174 ,  21.19150256566 ,  65.359560000009],
                              [  7.38818181174 ,  23.6525042761  ,  65.359560000009],
                              [  7.38818181174 ,  11.3474957239  ,  66.780419999975],
                              [  7.38818181174 ,  13.80849743434 ,  66.780419999975],
                              [  7.38818181174 ,  16.269499144745,  66.780419999975],
                              [  7.38818181174 ,  18.730500855255,  66.780419999975],
                              [  7.38818181174 ,  21.19150256566 ,  66.780419999975],
                              [  7.38818181174 ,  23.6525042761  ,  66.780419999975],
                              [  7.38818181174 ,  10.40352810147 ,  67.325419960854],
                              [  7.38818181174 ,  24.59647189853 ,  67.325419960854],
                              [  7.38818181174 ,  12.57799657912 ,  67.49085000003 ],
                              [  7.38818181174 ,  15.03899828956 ,  67.49085000003 ],
                              [  7.38818181174 ,  17.500000000035,  67.49085000003 ],
                              [  7.38818181174 ,  19.96100171044 ,  67.49085000003 ],
                              [  7.38818181174 ,  22.42200342088 ,  67.49085000003 ],
                              [  7.38818181174 ,  12.57799657912 ,  68.911709999996],
                              [  7.38818181174 ,  15.03899828956 ,  68.911709999996],
                              [  7.38818181174 ,  17.500000000035,  68.911709999996],
                              [  7.38818181174 ,  19.96100171044 ,  68.911709999996],
                              [  7.38818181174 ,  22.42200342088 ,  68.911709999996],
                              [  7.38818181174 ,  10.40352810147 ,  69.077140039172],
                              [  7.38818181174 ,  24.59647189853 ,  69.077140039172],
                              [  7.38818181174 ,  11.3474957239  ,  69.622140000051],
                              [  7.38818181174 ,  13.80849743434 ,  69.622140000051],
                              [  7.38818181174 ,  16.269499144745,  69.622140000051],
                              [  7.38818181174 ,  18.730500855255,  69.622140000051],
                              [  7.38818181174 ,  21.19150256566 ,  69.622140000051],
                              [  7.38818181174 ,  23.6525042761  ,  69.622140000051],
                              [  7.38818181174 ,  11.3474957239  ,  71.043000000089],
                              [  7.38818181174 ,  13.80849743434 ,  71.043000000089],
                              [  7.38818181174 ,  16.269499144745,  71.043000000089],
                              [  7.38818181174 ,  18.730500855255,  71.043000000089],
                              [  7.38818181174 ,  21.19150256566 ,  71.043000000089],
                              [  7.38818181174 ,  23.6525042761  ,  71.043000000089],
                              [  7.38818181174 ,  10.40352810147 ,  71.587999960895],
                              [  7.38818181174 ,  24.59647189853 ,  71.587999960895],
                              [  7.38818181174 ,  12.57799657912 ,  71.753429999999],
                              [  7.38818181174 ,  15.03899828956 ,  71.753429999999],
                              [  7.38818181174 ,  17.500000000035,  71.753429999999],
                              [  7.38818181174 ,  19.96100171044 ,  71.753429999999],
                              [  7.38818181174 ,  22.42200342088 ,  71.753429999999]]*Angstrom

# Set up configuration
central_region = BulkConfiguration(
    bravais_lattice=central_region_lattice,
    elements=central_region_elements,
    cartesian_coordinates=central_region_coordinates
    )

VG=numpy.linspace(-2,2,9)
for vg in VG:
  # Add metallic region
  metallic_region_0 = BoxRegion(
    vg*Volt,
    xmin = 0.0*Angstrom, xmax = 0.5*Angstrom,
    ymin = 0.0*Angstrom, ymax = 35.0*Angstrom,
    zmin = 12.7877*Angstrom, zmax = 59.6757113386*Angstrom,
  )

  metallic_regions = [metallic_region_0]
  central_region.setMetallicRegions(metallic_regions)

# Add dielectric region
  dielectric_region_0 = BoxRegion(
    4.0,
    xmin = 0.5*Angstrom, xmax = 3.58*Angstrom,
    ymin = 0.0*Angstrom, ymax = 35.0*Angstrom,
    zmin = 12.7877*Angstrom, zmax = 59.6757113386*Angstrom,
  )

  dielectric_regions = [dielectric_region_0]
  central_region.setDielectricRegions(dielectric_regions)

  device_configuration = DeviceConfiguration(
    central_region,
    [left_electrode, right_electrode]
    )

# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------
#----------------------------------------
# Basis Set
#----------------------------------------
  basis_set = DFTBDirectory("cp2k/scc/")

#----------------------------------------
# Pair Potentials
#----------------------------------------
  pair_potentials = DFTBDirectory("cp2k/scc/")

#----------------------------------------
# Numerical Accuracy Settings
#----------------------------------------
  left_electrode_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  left_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=left_electrode_k_point_sampling,
    )

  right_electrode_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  right_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=right_electrode_k_point_sampling,
    )

  device_k_point_sampling = MonkhorstPackGrid(
    nc=101,
    )
  device_numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=device_k_point_sampling,
    )

#----------------------------------------
# Iteration Control Settings
#----------------------------------------
  left_electrode_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

  right_electrode_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

  device_iteration_control_parameters = IterationControlParameters(
    max_steps=300,
    tolerance=5e-05,
    number_of_history_steps=30,
    )

#----------------------------------------
# Poisson Solver Settings
#----------------------------------------
  left_electrode_poisson_solver = MultigridSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]]
    )

  right_electrode_poisson_solver = MultigridSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]]
    )

#----------------------------------------
# Electrode Calculators
#----------------------------------------
  left_electrode_calculator = SlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=left_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=left_electrode_iteration_control_parameters,
    poisson_solver=left_electrode_poisson_solver,
    )

  right_electrode_calculator = SlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=right_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=right_electrode_iteration_control_parameters,
    poisson_solver=right_electrode_poisson_solver,
    )

#----------------------------------------
# Device Calculator
#----------------------------------------
  calculator = DeviceSlaterKosterCalculator(
    basis_set=basis_set,
    pair_potentials=pair_potentials,
    numerical_accuracy_parameters=device_numerical_accuracy_parameters,
    iteration_control_parameters=device_iteration_control_parameters,
    electrode_calculators=
        [left_electrode_calculator, right_electrode_calculator],
    )

  device_configuration.setCalculator(calculator)
  #nlprint(device_configuration)
  device_configuration.update()
  nlsave('Device_11-9AGNR_47_%s.nc'%vg, device_configuration)

# -------------------------------------------------------------
# Transmission Spectrum
# -------------------------------------------------------------
  kpoint_grid = MonkhorstPackGrid()

  transmission_spectrum = TransmissionSpectrum(
    configuration=device_configuration,
    energies=numpy.linspace(-1,1,101)*eV,
    kpoints=kpoint_grid,
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    self_energy_calculator=RecursionSelfEnergy(),
    )
  nlsave('Device_11-9AGNR_47_%s.nc'%vg, transmission_spectrum)
  nlprint(transmission_spectrum)

#  T=[1,50,100,150,200,250,300,350,400,450,500]
  T=numpy.linspace(250,350,11)
  for temp in T:
    temperature=temp*Kelvin
    conductance=transmission_spectrum.conductance(electrode_temperatures=(temperature,temperature))
    current=transmission_spectrum.current(electrode_temperatures=(temperature,temperature))
    if ( processIsMaster() ):
      print "Gate voltage = %s: Conductance = %s at T = %s"%(vg,conductance,temperature)
      print "Gate voltage = %s: Current = %s at T = %s"%(vg,current,temperature)

# -------------------------------------------------------------
# IV Curve
# -------------------------------------------------------------
  biases = [0.000000, 0.200000, 0.400000, 0.600000, 0.800000, 1.000000,
          1.200000, 1.400000, 1.600000, 1.800000, 2.000000]*Volt

  kpoint_grid = MonkhorstPackGrid()

  iv_curve = IVCurve(
    configuration=device_configuration,
    biases=biases,
    energies=numpy.linspace(-1,1,101)*eV,
    kpoints=kpoint_grid,
    self_energy_calculator=RecursionSelfEnergy(),
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    selfconsistent_configurations_filename_prefix=NoCheckpointHandler,
    log_filename_prefix=None
    )
  nlsave('Device_11-9AGNR_47_%s.nc'%vg, iv_curve)
  nlprint(iv_curve)
